<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<!-- JQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

</head>
<body>
	<fieldset>
		<legend>Upload</legend>
		<form action="/file/upload" method="post" enctype="multipart/form-data">
			<input type="text" name="text" placeholder="아무 텍스트"><br>
			<input type="file" name="files" multiple>
			<button>전송</button>
		</form>
	</fieldset>
	
	<button id="list">파일 목록 가져오기</button>
	<fieldset>
		<legend>File list</legend>
		<div id="files"></div>
	</fieldset>
	
	<script>
		$("#list").on("click", ()=>{
			$.ajax({
				url:"file/list"
			}).done((resp)=>{
				$("#files").html("<tr> " +
		                "<th>seq</th> " +
		                "<th>파일 이름</th> " +
		                "</tr>");
		            for (let item of resp) {
		                let tr = $("<tr>");
		                let a = $("<a>");
		                a.attr("href", "file/download?sysname=" + item.sysName);
		                
		                let seq = $("<td>").html(item.seq);
		                let oriName = $("<td>").html(item.oriName);
						a.append(oriName);
		                
		                tr.append(seq);
		                tr.append(a);

		                $("#files").append(tr);
		            }
				
			});
		});
		
	</script>
</body>
</html>